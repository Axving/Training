# 阿里云机器学习PAI-DSW服务器--酷蛙FaceChain

摘要：从阿里云机器学习PAI-DSW服务器部署，克隆项目、运行项目

## 一、阿里云机器学习平台

进入aliyun，依次选择 产品 -- 人工智能与机器学习 -- 机器学习平台PAI ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_5aabe4d3fb594ae4b30534787f2438e0.png) 由此进入到下界面： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_0903687a888a4cd1991447c73c4f286a.png) 在该界面下拉，选择左边0元/三月内有效： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_d1d53e884a5545458b516c126bab3fe5.png) 接着还是选择左边的那个，立即试用： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_f67c22d7a79e44aa9ecbc86714096421.png) 进入看到如下页面： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_ca304c5942c642b8a51b362c8dac59c7.png) 点击第一项： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_d99410e536914037966ad8867745040c.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_c3e89955a9964c31838bab003947dce3.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_8e974181a1514af5a23624054490c9d7.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_7296aa02e6944e86bc088a8ce67e4b48.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_1fe4f923a62e41f89509f8fa425f2174.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_f876f5bad04f40bf91bc2ae3c0f1a77e.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_551333b40c7d4194b27abd01f038e7b6.png) 选择GPU -- A10 ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_e6b817cf181a444abbf1ddfba536c6ea.png) 这里选择默认的官方镜像 modelscope:ubuntu20.04-cuda11.7.1-py38-torch2.0.1-tf1.15.5-1.8.1 ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_88207a3d6e4e4545aaafbb3003dceca4.png) 然后点击下一步： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_05b4bafdb5e64761ac9e1a2ef3f478f7.png) 我们看到可以是可抵扣，然后创建实例： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_369b6d6ee4004eef95c85d31444b145e.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_77f3cac06fca4b8aa170a5e803011377.png) 等待实例创建环境准备完成，然后点击右侧的打开： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_ab300637c50a4dfba740b0888243a7e7.png) 进入： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_bf41259785794c5f960b1c026c65627e.png) 



## 二、项目运行

下面是我的操作： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_ab0e875a06fb4d2aabb6382693875eb2.png) ```` apt-get update apt-get install git-lfs git init git lfs install ```` 克隆项目： git clone https://github.com/modelscope/facechain.git --depth 1 GIT_LFS_SKIP_SMUDGE=1 ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_ea2654f4dfa04b098cad064d963ef4d9.png) 接着安装依赖： ```` cd ./facechain pip install -r requirements.txt pip install -U openmim  ```` ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_a819ea1e27674549ac6b9c8e7b3c1bc0.png) 进入文件夹在run_inference.py文件第8行添加代码。其作用是让运行的时候不会重复下载模型从而节省时间。 ```` snapshot_download('some-model-id') ```` ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_030c29a3fda84e6e9dc038bb4b09aa43.png) 运行代码则在命令行输入python app.py，在页面直接点击这个链接进入gradio界面即可。 ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_32d10f1392544992a99cbffe48b1e3d3.png) 进入页面： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_02ac3b6b73d64fb7825b42a84f0982c4.png) 这里选择人物形象训练 -- MajicmixRealistic_v6，从本机选择几张图片上传，上传好后点击开始训练。 这时在终端中的情况： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_6c5ac77204104308b61ed1787d4ffa84.png) ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_66b5346ef5134c3c8a0d6e0fbabf1026.png) 回到生成页面，点击上面的无限风格形象写真： ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_dd9e2f01331746efba1e69526a24b9b8.png) 选择好后，开始生成就好。 ![image.png](https://ucc.alicdn.com/pic/developer-ecology/2yk4pcxhynfxu_cdee0094fb7d4960b0795583a0189cc8.png)